syntax = "proto3";

package seigr.ui;

import "touchscreen.proto";  // Import touchscreen interactions

// ================================
// Seigr User Interface Protocol  
// ================================

// UI operation types
enum UIOperation {
    UI_UNKNOWN = 0;
    CREATE_WIDGET = 1;
    UPDATE_WIDGET = 2;
    DELETE_WIDGET = 3;
    RENDER_VIEW = 4;
    HANDLE_INTERACTION = 5;
    APPLY_THEME = 6;
    ANIMATE_ELEMENT = 7;
    SHOW_DIALOG = 8;
    HIDE_DIALOG = 9;
    NAVIGATE_VIEW = 10;
}

// Widget types
enum WidgetType {
    WIDGET_UNKNOWN = 0;
    BUTTON = 1;
    LABEL = 2;
    TEXT_INPUT = 3;
    TEXT_AREA = 4;
    CHECKBOX = 5;
    RADIO_BUTTON = 6;
    DROPDOWN = 7;
    SLIDER = 8;
    PROGRESS_BAR = 9;
    IMAGE_VIEW = 10;
    LIST_VIEW = 11;
    TREE_VIEW = 12;
    TABLE = 13;
    CHART = 14;
    SENARY_COUNTER = 15;        // Senary number widget
    ENERGY_INDICATOR = 16;      // Energy level display
}

// UI interaction types
enum InteractionType {
    INTERACTION_UNKNOWN = 0;
    TOUCH = 1;
    CLICK = 2;
    DOUBLE_CLICK = 3;
    LONG_PRESS = 4;
    SWIPE = 5;
    PINCH = 6;
    ROTATE = 7;
    DRAG = 8;
    DROP = 9;
    HOVER = 10;
}

// Animation types
enum AnimationType {
    ANIMATION_UNKNOWN = 0;
    FADE_IN = 1;
    FADE_OUT = 2;
    SLIDE_IN = 3;
    SLIDE_OUT = 4;
    SCALE_UP = 5;
    SCALE_DOWN = 6;
    ROTATE_ANIMATION = 7;
    BOUNCE = 8;
    PULSE = 9;
    CUSTOM = 10;
}

// UI widget
message UIWidget {
    string widget_id = 1;
    WidgetType type = 2;
    string label = 3;
    WidgetGeometry geometry = 4;
    WidgetStyle style = 5;
    WidgetState state = 6;
    repeated UIWidget children = 7;
    InteractionHandler interaction = 8;
    DataModel data = 9;
    map<string, string> properties = 10;
}

// Widget geometry
message WidgetGeometry {
    float x = 1;
    float y = 2;
    float width = 3;
    float height = 4;
    float rotation = 5;
    float scale_x = 6;
    float scale_y = 7;
    uint32 z_index = 8;
}

// Widget styling
message WidgetStyle {
    string background_color = 1;
    string foreground_color = 2;
    string border_color = 3;
    float border_width = 4;
    float border_radius = 5;
    string font_family = 6;
    uint32 font_size = 7;
    string font_weight = 8;
    float opacity = 9;
    string shadow = 10;
    map<string, string> custom_styles = 11;
}

// Widget state
message WidgetState {
    bool is_visible = 1;
    bool is_enabled = 2;
    bool is_focused = 3;
    bool is_selected = 4;
    bool is_hovered = 5;
    bool is_pressed = 6;
    string value = 7;
    map<string, string> state_data = 8;
}

// Interaction handler
message InteractionHandler {
    InteractionType interaction_type = 1;
    string callback_function = 2;
    map<string, string> parameters = 3;
    bool consume_event = 4;
    float interaction_threshold = 5;  // Sensitivity threshold for interactions
    seigr.touchscreen.TouchEvent touch_event = 6;  // Reference to touchscreen interaction
}

// Data model for widgets
message DataModel {
    string model_id = 1;
    string model_type = 2;
    repeated DataItem items = 3;
    map<string, string> metadata = 4;
    bool auto_refresh = 5;
    uint32 refresh_interval_ms = 6;
}

// Data item
message DataItem {
    string item_id = 1;
    string label = 2;
    string value = 3;
    string icon = 4;
    bool is_selected = 5;
    map<string, string> attributes = 6;
}

// UI view
message UIView {
    string view_id = 1;
    string view_name = 2;
    repeated UIWidget widgets = 3;
    ViewLayout layout = 4;
    UITheme theme = 5;
    NavigationInfo navigation = 6;
    ViewState state = 7;
}

// View layout
message ViewLayout {
    string layout_type = 1;     // grid, stack, flow, absolute
    uint32 columns = 2;
    uint32 rows = 3;
    float spacing = 4;
    float padding = 5;
    string alignment = 6;
    bool responsive = 7;
}

// UI theme
message UITheme {
    string theme_id = 1;
    string theme_name = 2;
    ColorScheme colors = 3;
    FontScheme fonts = 4;
    map<string, string> assets = 5;
    bool dark_mode = 6;
    bool energy_saving = 7;
}

// Color scheme
message ColorScheme {
    string primary = 1;
    string secondary = 2;
    string background = 3;
    string surface = 4;
    string text_primary = 5;
    string text_secondary = 6;
    string accent = 7;
    string error = 8;
    string warning = 9;
    string success = 10;
}

// Font scheme
message FontScheme {
    string heading_font = 1;
    string body_font = 2;
    string monospace_font = 3;
    uint32 base_size = 4;
    float scale_factor = 5;
    map<string, uint32> size_variants = 6;
}

// Navigation info
message NavigationInfo {
    string current_route = 1;
    repeated string route_stack = 2;
    map<string, string> route_parameters = 3;
    bool can_go_back = 4;
    bool can_go_forward = 5;
}

// View state
message ViewState {
    bool is_active = 1;
    bool is_loading = 2;
    string error_message = 3;
    map<string, string> user_data = 4;
    uint64 last_updated = 5;
}

// UI animation
message UIAnimation {
    string animation_id = 1;
    string target_widget_id = 2;
    AnimationType type = 3;
    uint32 duration_ms = 4;
    string easing_function = 5;
    float start_value = 6;
    float end_value = 7;
    bool auto_reverse = 8;
    uint32 repeat_count = 9;
}

// Dialog configuration
message DialogConfig {
    string dialog_id = 1;
    string title = 2;
    string message = 3;
    repeated DialogButton buttons = 4;
    string icon = 5;
    bool modal = 6;
    bool dismissible = 7;
    uint32 auto_dismiss_ms = 8;
}

// Dialog button
message DialogButton {
    string button_id = 1;
    string label = 2;
    string action = 3;
    bool is_primary = 4;
    bool is_destructive = 5;
}

// UI interaction delegates to touchscreen protocol
message UIInteraction {
    string interaction_id = 1;
    InteractionType type = 2;
    string target_widget_id = 3;
    seigr.touchscreen.TouchEvent touch_event = 4;  // Delegate to touchscreen
    uint64 timestamp = 5;
}

// UI request
message UIRequest {
    UIOperation operation = 1;
    string target_id = 2;
    UIWidget widget = 3;
    UIView view = 4;
    UIAnimation animation = 5;
    DialogConfig dialog = 6;
    UIInteraction interaction = 7;
    map<string, string> parameters = 8;
}

// UI response
message UIResponse {
    bool success = 1;
    string message = 2;
    string result_id = 3;
    bytes rendered_data = 4;
    UIWidget updated_widget = 5;
    UIView updated_view = 6;
    uint64 response_time = 7;
}

// UI service
service UIService {
    rpc CreateWidget(UIRequest) returns (UIResponse);
    rpc UpdateWidget(UIRequest) returns (UIResponse);
    rpc DeleteWidget(UIRequest) returns (UIResponse);
    rpc RenderView(UIRequest) returns (UIResponse);
    rpc HandleInteraction(UIInteraction) returns (UIResponse);
    rpc ApplyTheme(UIRequest) returns (UIResponse);
    rpc AnimateElement(UIAnimation) returns (UIResponse);
    rpc ShowDialog(DialogConfig) returns (UIResponse);
    rpc HideDialog(UIRequest) returns (UIResponse);
    rpc NavigateView(UIRequest) returns (UIResponse);
}
